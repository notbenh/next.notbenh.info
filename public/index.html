<!-- -*- mode:javascript -*--->
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  <title>notbenh.info</title>
  <meta name="Description"
        content="notbenh does silly things on the internet."/>
  <script src="assets/vendor/jquery.terminal/js/jquery-1.7.1.min.js"></script>
  <script src="assets/vendor/jquery.terminal/js/jquery.mousewheel-min.js"></script>
  <script src="assets/vendor/jquery.terminal/js/jquery.terminal-min.js"></script>
  <link href="assets/vendor/jquery.terminal/css/jquery.terminal.css" rel="stylesheet"/>
  <style>
    body{ background-color: #000 }
    div#terminal {
      position:absolute;
      top: 1px;
      right: 7px;
      bottom: 1px;
      left: 1px;
      overflow: auto;
    }
    div#terminal {
      color: #55FF55;
    }
    div.cmd span.cursor.inverted {
      background-color: #55FF55;
    }
    @-moz-keyframes roll { 
      100% { 
        -moz-transform: rotate(360deg);
      }
    } 
    @-o-keyframes roll { 
      100% { 
        -o-transform: rotate(360deg); 
      } 
    } 
    @-webkit-keyframes roll {
      100% { 
        -webkit-transform: rotate(360deg); 
      } 
    } 
    *.barrel_roll{ 
      -moz-animation-name: roll; 
      -moz-animation-duration: 4s; 
      -moz-animation-iteration-count: 1; 
      -o-animation-name: roll; 
      -o-animation-duration: 4s; 
      -o-animation-iteration-count: 1; 
      -webkit-animation-name: roll; 
      -webkit-animation-duration: 4s; 
      -webkit-animation-iteration-count: 1; 
    }
  </style>
<script>

jQuery(function($, undefined) {
  function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function SAY (thing){
    fn = function(){this.echo(thing)}
    return fn
  }

  var docs = {
    twitter: {GOAL:'go to my twitter'},
    blog   : {GOAL:'go to my blog'},
    suggest: {GOAL:'suggest new features'},
    resume : {GOAL:'just the link to my resume'},
    about  : {GOAL:'just the link to my about me page'},
    github : {GOAL:'just the link to my github account'},
    roll   : {GOAL    : 'roll some dice',
              EXAMPLES: ['roll d20', 'roll 3d10', 'roll 5d2 d4 d13'],
              SYNTAX  : 'a die is defined by "d" followed by a digit. you can roll the same die multipe times by preceeding the die with the number of times to roll',
              TODO    : 'currently roll with out any arguments does not do anything, should give you the help text or at least tell you why you got nothing'
             },
    repeat : {GOAL: 'take the URL of an image and then make a single page with a repeating background for extra sillyness',
              TODO: 'ideally this should just =doit= as it is possible, though we can always throw to the existing PHP thing'
             },
    flip   : {GOAL: 'flip a coin' },
    yn     : {GOAL: 'random yes or no'},
    reload : {GOAL: 'reload the page'},
    // barrel : {GOAL: '360'}, // EASTEREGG
    color  : {GOAL    : 'build a graident between two html/hex colors',
              EXAMPLES: ['color FFF 000', 'color 012345 FEDCBA'],
              TODO    : 'currently only does two colors, inverse has not yet been implimented so you need to select to read the text, hardcoded step at 10'
             },
    tdone  : {GOAL: '[incomplete] localstore version of tdone', TODO: 'currently this is not implimented'},
  }

  var term_actions = {
    twitter: SAY('https://twitter.com/notbenh'),
    blog   : SAY('http:/notbenh.github.io'),
    suggest: SAY('create an issue https://github.com/notbenh/next.notbenh.info/issues or just yell at me on twitter: https://twitter.com/notbenhyy'),
    resume : SAY('http://resume.notbenh.info'),
    about  : SAY('http://about.notbenh.info'),
    github : SAY('https://github.com/notbenh'),
    repeat : SAY('for now just got here: http://notbenh.info/repeater.php'),
    tdone  : SAY('TODO: --- not yet implimented ---'),
    roll   : function(dice){
              if(dice.length == 0){ return help(['roll']) }
              var results = [];
              var re = /^(\d*)?d(\d+)/;
              dice.forEach(function(die){
                  if (die == 'barrel'){
                    results.push('http://notbenh.info/repeater.php?img=media%2Fbarrel.gif')
                  }
                  else{
                    var parse = re.exec(die);
                    var count = parse[1] === undefined ? 1 : parse[1];
                    var max   = parse[2];
                    for(i=0; i< count; i++){
                      results.push('d' + max + ': ' + getRandomInt(1,max))
                    }
                  }
                }
              )
              this.echo( results.join("\n"));
             },
    barrel : function(type){
                if(type[0] === 'roll'){
                  $('#terminal').addClass('barrel_roll')
                  setTimeout("$('#terminal').removeClass('barrel_roll')",4200);
                }
              },
    flip   : function(){ this.echo( getRandomInt(0,1) == 1 ? 'heads' : 'tails' )},
    yn     : function(){ this.echo( getRandomInt(0,1) == 1 ? 'yes' : 'no')},
    reload : function(){ window.location.reload() },
    color  : function(colors){
              if(colors.length == 0){ return help(['color']) }
              function inverse(c){ return c}
              function swatch (c){return '  [[;#'+ inverse(c) +';#' + c +';swatch]#' + c + ']'}
              function unhex  (c){
                if(c.length === 3){
                  rgb = /(.)(.)(.)/.exec(c);
                  return [parseInt(''.concat(rgb[1],rgb[1]),16),
                          parseInt(''.concat(rgb[2],rgb[2]),16),
                          parseInt(''.concat(rgb[3],rgb[3]),16),
                         ];
                }
                else {
                  rgb = /(..)(..)(..)/.exec(c)
                  return [parseInt(rgb[1],16),
                          parseInt(rgb[2],16),
                          parseInt(rgb[3],16),
                         ];
                }
              }
              function rehex (r,g,b){ return ''.concat(
                ('00' + parseInt(r).toString(16)).substr(-2),
                ('00' + parseInt(g).toString(16)).substr(-2),
                ('00' + parseInt(b).toString(16)).substr(-2)
              ) }
              if(colors.length !== 2) { return 'ERROR currently color only takes two values' }
              var step = 10; // TODO: this is hardcoded for now
              var a = unhex(colors[0]);
              var b = unhex(colors[1]);
              var r_diff = (a[0]-b[0])/step;
              var g_diff = (a[1]-b[1])/step;
              var b_diff = (a[2]-b[2])/step;
              var results = [];
              for(i=0; i<= step; i++){ results.push(swatch(rehex(a[0]-(i*r_diff), a[1]-(i*g_diff), a[2]-(i*b_diff) ))) }
              this.echo(results.join("\n"))
            },
    help   : function(verb){
              var buffer = ''
              if(verb === undefined){
                buffer += "for more help on any topic ask for help followed by topic. for example if you wanted to know more about 'roll' then say 'help roll'\n";
                buffer += "here are some of the helpful things you can do: \n"
                Object.keys(docs).sort().forEach(function(verb){
                  buffer += "  " + verb + " : " + docs[verb]['GOAL'] + "\n"
                })
                // TODO: it would be nice if this was formated such that all the : are aligned
              }
              else {
                if(docs[verb] === undefined){
                  this.error("I do not know how to "+verb)
                }
                else {
                  buffer += "  " + verb + " : " + docs[verb]['GOAL'] + "\n"
                  // SYNTAX
                  if( docs[verb]['SYNTAX'] !== undefined) {
                    buffer += "  SYNTAX: " + docs[verb]['SYNTAX'] + "\n"
                  }
                  // EXAMPLES
                  if( docs[verb]['EXAMPLES'] !== undefined){
                    buffer += "  EXAMPLES:\n"
                    docs[verb]['EXAMPLES'].forEach(function(example){
                      buffer += '    ' + example + "\n"
                    })
                  }
                  // NOTE
                  if( docs[verb]['NOTE'] !== undefined) {
                    buffer += "  NOTE: " + docs[verb]['NOTE'] + "\n"
                  }
                  // TODO
                  if( docs[verb]['TODO'] !== undefined) {
                    buffer += "  TODO: " + docs[verb]['TODO'] + "\n"
                  }
                }
              }
              this.echo(buffer)
            },
  }
  var term_options = { 
    greetings: 'notbenh.info: do things by typing (if you get lost ask for "help")',
    name: 'notbenh_shell',
    prompt: '> '
  };
  $('#terminal').terminal(term_actions,term_options);
});

</script>
</head>
<body>
  <div id='terminal'></div>
</body>
</html>
