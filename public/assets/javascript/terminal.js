// Generated by CoffeeScript 1.6.3
var Terminal,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

Terminal = (function() {
  function Terminal(id, options) {
    this.id = id;
    this.options = options;
    this._preform_action = __bind(this._preform_action, this);
    this.element = $(this.id).terminal(this._preform_action, this.options);
  }

  Terminal.prototype._preform_action = function(command, term) {
    var args, e, result, result_url_match, verb;
    args = command.split(' ');
    verb = args.shift();
    if (command === '') {
      term.echo('');
    } else if (this.actions[verb] === void 0) {
      term.error("I do not know how to " + verb);
    } else {
      try {
        result = this.actions[verb](args);
        console.info(verb, args, this.actions[verb], result);
        if (result !== void 0) {
          result_url_match = /https?:\/\/(?:(?!&[^;]+;)[^\s:"'<>)])+/g.exec(result);
          if (result_url_match !== null && result_url_match[0] === result) {
            window.open(result);
            result += ' [opened in new tab]';
          }
          term.echo(new String(result));
        }
      } catch (_error) {
        e = _error;
        term.error(new String(e));
      }
    }
  };

  Terminal.prototype.actions = {};

  Terminal.prototype.docs = {};

  Terminal.prototype._add_action = function(name, action, docs) {
    this.actions[name] = action;
    return this.docs[name] = docs;
  };

  return Terminal;

})();
